#! /bin/bash

SCREEN_MAX_BRIGHTNESS=$(cat /sys/class/backlight/intel_backlight/max_brightness)
CURRENT_SCREEN_BRIGHTNESS=$(cat /sys/class/backlight/intel_backlight/brightness)

if [ ${1:0:1} = + ] ; then
	REQUESTED_SCREEN_BRIGHTNESS=$(($SCREEN_MAX_BRIGHTNESS * ${1:1}))
        REQUESTED_SCREEN_BRIGHTNESS=$(($REQUESTED_SCREEN_BRIGHTNESS / 100))
        REQUESTED_SCREEN_BRIGHTNESS=$(($CURRENT_SCREEN_BRIGHTNESS + $REQUESTED_SCREEN_BRIGHTNESS))
elif [ ${1:0:1} = - ] ; then
	REQUESTED_SCREEN_BRIGHTNESS=$(($SCREEN_MAX_BRIGHTNESS * ${1:1}))
	REQUESTED_SCREEN_BRIGHTNESS=$(($REQUESTED_SCREEN_BRIGHTNESS / 100))
	REQUESTED_SCREEN_BRIGHTNESS=$(($CURRENT_SCREEN_BRIGHTNESS - $REQUESTED_SCREEN_BRIGHTNESS))
else
	REQUESTED_SCREEN_BRIGHTNESS=$(($SCREEN_MAX_BRIGHTNESS * $1))
	REQUESTED_SCREEN_BRIGHTNESS=$(($REQUESTED_SCREEN_BRIGHTNESS / 100))
fi
REQUESTED_SCREEN_BRIGHTNESS=$(( REQUESTED_SCREEN_BRIGHTNESS > SCREEN_MAX_BRIGHTNESS ? SCREEN_MAX_BRIGHTNESS : REQUESTED_SCREEN_BRIGHTNESS ))
REQUESTED_SCREEN_BRIGHTNESS=$(( REQUESTED_SCREEN_BRIGHTNESS < 0 ? 0 : REQUESTED_SCREEN_BRIGHTNESS ))
tee /sys/class/backlight/intel_backlight/brightness <<< "$REQUESTED_SCREEN_BRIGHTNESS" #need to be root to do this
